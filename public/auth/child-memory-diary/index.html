<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>アプリを開いています…</title>
  </head>
  <body>
    <div style="font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial; padding:24px;">
      <div id="msg">アプリを開いています…</div>
      <div style="margin-top:16px;">
        <a id="open" href="#" style="display:inline-block; padding:10px 14px; border:1px solid #ccc; border-radius:10px;">
          アプリを開く
        </a>
      </div>
      <div style="margin-top:16px;">
        <a id="help" href="https://ponk1-tech.com/auth/help" style="color:#666;">開けないとき</a>
      </div>
    </div>

    <script>
      const scheme = "childmemorydiary://bridge";
      const full = location.href; // Supabaseのパラメータ込み
      const deep = scheme + "?from=" + encodeURIComponent(full);

      document.getElementById("open").href = deep;

      // 自動で開く
      location.href = deep;

      // 失敗した時の表示（ユーザーが迷子にならない）
      setTimeout(() => {
        document.getElementById("msg").textContent =
          "アプリが開かない場合は「アプリを開く」を押してください。";
      }, 1200);
    </script>
  </body>
</html>
